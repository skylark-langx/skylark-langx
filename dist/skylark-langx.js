/**
 * skylark-langx - A simple JavaScript language extension library, including class support, Evented class, Deferred class and some commonly used tool functions.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.5
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(t,r){var e=r.define,n=r.require,i="function"==typeof e&&e.amd,a=!i&&"undefined"!=typeof exports;if(!i&&!e){var s={};e=r.define=function(t,r,e){"function"==typeof e?(s[t]={factory:e,deps:r.map(function(r){return function(t,r){if("."!==t[0])return t;var e=r.split("/"),n=t.split("/");e.pop();for(var i=0;i<n.length;i++)"."!=n[i]&&(".."==n[i]?e.pop():e.push(n[i]));return e.join("/")}(r,t)}),resolved:!1,exports:null},n(t)):s[t]={factory:null,resolved:!0,exports:e}},n=r.require=function(t){if(!s.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var e=s[t];if(!e.resolved){var i=[];e.deps.forEach(function(t){i.push(n(t))}),e.exports=e.factory.apply(r,i)||null,e.resolved=!0}return e.exports}}if(!e)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,r){t("skylark-langx/skylark",["skylark-langx-ns"],function(t){return t}),t("skylark-langx/arrays",["skylark-langx-arrays"],function(t){return t}),t("skylark-langx/klass",["skylark-langx-klass"],function(t){return t}),t("skylark-langx/ArrayStore",["./klass"],function(t){var r=function(t){if(!t)return t;var e=!!t.then;function n(n){t[n]=function(){var i=arguments,a=Deferred.when(t,function(t){return r(Array.prototype[n].apply(t,i))});if("forEach"!==n||e)return a}}return e&&(t=Object.delegate(t)),n("forEach"),n("filter"),n("map"),null==t.total&&(t.total=Deferred.when(t,function(t){return t.length})),t},e=t({klassName:"ArrayStore",queryEngine:function(t,r){switch(typeof t){default:throw new Error("Can not query with a "+typeof t);case"object":case"undefined":var e=t;t=function(t){for(var r in e){var n=e[r];if(n&&n.test){if(!n.test(t[r],t))return!1}else if(n!=t[r])return!1}return!0};break;case"string":if(!this[t])throw new Error("No filter function "+t+" was found in store");t=this[t];case"function":}function n(e){var n=function(t,r,e){var n,i=0,a=t&&t.length||0,s=[];a&&"string"==typeof t&&(t=t.split(""));"string"==typeof r&&(r=cache[r]||buildFn(r));if(e)for(;i<a;++i)n=t[i],r.call(e,n,i,t)&&s.push(n);else for(;i<a;++i)n=t[i],r(n,i,t)&&s.push(n);return s}(e,t),i=r&&r.sort;if(i&&n.sort("function"==typeof i?i:function(t,r){for(var e,n=0;e=i[n];n++){var a=t[e.attribute],s=r[e.attribute];if(a=null!=a?a.valueOf():a,s=null!=s?s.valueOf():s,a!=s)return!!e.descending==(null==a||a>s)?-1:1}return 0}),r&&(r.start||r.count)){var a=n.length;(n=n.slice(r.start||0,(r.start||0)+(r.count||1/0))).total=a}return n}return n.matches=t,n},idProperty:"id",get:function(t){return this.data[this.index[t]]},getIdentity:function(t){return t[this.idProperty]},put:function(t,r){var e=this.data,n=this.index,i=this.idProperty,a=t[i]=r&&"id"in r?r.id:i in t?t[i]:Math.random();if(a in n){if(r&&!1===r.overwrite)throw new Error("Object already exists");e[n[a]]=t}else n[a]=e.push(t)-1;return a},add:function(t,r){return(r=r||{}).overwrite=!1,this.put(t,r)},remove:function(t){var r=this.index,e=this.data;if(t in r)return e.splice(r[t],1),this.setData(e),!0},query:function(t,e){return r(this.queryEngine(t,e)(this.data))},setData:function(t){t.items?(this.idProperty=t.identifier||this.idProperty,t=this.data=t.items):this.data=t,this.index={};for(var r=0,e=t.length;r<e;r++)this.index[t[r][this.idProperty]]=r},init:function(t){for(var r in t)this[r]=t[r];this.setData(this.data||[])}});return e}),t("skylark-langx/aspect",[],function(){var t,r=0;function e(e){return function(n,i,a,s){var u,o=n[i];o&&o.target==n||(n[i]=u=function(){for(var e=r,n=arguments,i=u.before;i;)n=i.advice.apply(this,n)||n,i=i.next;if(u.around)var a=u.around.advice(this,n);for(var s=u.after;s&&s.id<e;){if(s.receiveArguments){var o=s.advice.apply(this,n);a=o===t?a:o}else a=s.advice.call(this,a,n);s=s.next}return a},o&&(u.around={advice:function(t,r){return o.apply(t,r)}}),u.target=n);var l=function(t,e,n,i){var a,s=t[e],u="around"==e;if(u){var o=n(function(){return s.advice(this,arguments)});a={remove:function(){o&&(o=t=n=null)},advice:function(t,r){return o?o.apply(t,r):s.advice(t,r)}}}else a={remove:function(){if(a.advice){var r=a.previous,i=a.next;i||r?(r?r.next=i:t[e]=i,i&&(i.previous=r)):delete t[e],t=n=a.advice=null}},id:r++,advice:n,receiveArguments:i};if(s&&!u)if("after"==e){for(;s.next&&(s=s.next););s.next=a,a.previous=s}else"before"==e&&(t[e]=a,a.next=s,s.previous=a);else t[e]=a;return a}(u||o,e,a,s);return a=null,l}}return{after:e("after"),around:e("around"),before:e("before")}}),t("skylark-langx/async",["skylark-langx-async"],function(t){return t}),t("skylark-langx/datetimes",["skylark-langx-datetimes"],function(t){return t}),t("skylark-langx/Deferred",["skylark-langx-async/Deferred"],function(t){return t}),t("skylark-langx/Evented",["skylark-langx-emitter"],function(t){return t}),t("skylark-langx/funcs",["skylark-langx-funcs"],function(t){return t}),t("skylark-langx/hoster",["skylark-langx-hoster"],function(t){return t}),t("skylark-langx/numbers",["skylark-langx-numbers"],function(t){return t}),t("skylark-langx/objects",["skylark-langx-objects"],function(t){return t}),t("skylark-langx/strings",[],function(){var t=Object.freeze({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"});function r(r){return t[r]}var e=/[&<>"'`=]/g;var n=0;function i(t,r){var e,n,i,a,s,u,o,l=arguments.callee;return l.cache[t]||(l.cache[t]=(e=t,n=/^[\w\-]+$/.test(t)?l.get(t):(e="template(string)",t),i=1,a=("try { "+(l.variable?"var "+l.variable+" = this.stash;":"with (this.stash) { ")+"this.ret += '"+n.replace(/<%/g,"").replace(/%>/g,"").replace(/'(?![^\x11\x13]+?\x13)/g,"\\x27").replace(/^\s*|\s*$/g,"").replace(/\n|\r\n/g,function(){return"';\nthis.line = "+ ++i+"; this.ret += '\\n"}).replace(/\x11=raw(.+?)\x13/g,"' + ($1) + '").replace(/\x11=(.+?)\x13/g,"' + this.escapeHTML($1) + '").replace(/\x11(.+?)\x13/g,"'; $1; this.ret += '")+"'; "+(l.variable?"":"}")+"return this.ret;} catch (e) { throw 'TemplateError: ' + e + ' (on "+e+"' + ' line ' + this.line + ')'; } //@ sourceURL="+e+"\n").replace(/this\.ret \+= '';/g,""),s=new Function(a),u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#x22;","'":"&#x27;"},o=function(t){return(""+t).replace(/[&<>\'\"]/g,function(t){return u[t]})},function(t){return s.call(l.context={escapeHTML:o,line:1,ret:"",stash:t})})),r?l.cache[t](r):l.cache[t]}return i.cache={},i.get=function(t){return document.getElementById(t).innerHTML},{camelCase:function(t){return t.replace(/-([\da-z])/g,function(t){return t.toUpperCase().replace("-","")})},dasherize:function(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()},deserializeValue:function(t){try{return t?"true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?JSON.parse(t):t):t}catch(r){return t}},escapeHTML:function(t){if(null==t)return"";if(!t)return String(t);return t.toString().replace(e,r)},generateUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=16*Math.random()|0,e="x"===t?r:3&r|8;return e.toString(16)})},lowerFirst:function(t){return t.charAt(0).toLowerCase()+t.slice(1)},rtrim:function(t){return t.replace(/\s+$/g,"")},serializeValue:function(t){return JSON.stringify(t)},substitute:function(t,r,e,n){function i(t,r){if(t.match(/\./)){var e,n=function(t,r){var i=t.pop();return i?r[i]?n(t,e=r[i]):null:e};return n(t.split(".").reverse(),r)}return r[t]}return n=n||window,e=e?proxy(n,e):function(t){return t},t.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(t,a,s){var u=i(a,r);return s&&(u=i(s,n).call(n,u,a)),e(u,a).toString()})},slugify:function(t){t=(t=t.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var r="ÁÄÂÀÃÅČÇĆĎÉĚËÈÊẼĔȆÍÌÎÏŇÑÓÖÒÔÕØŘŔŠŤÚŮÜÙÛÝŸŽáäâàãåčçćďéěëèêẽĕȇíìîïňñóöòôõøðřŕšťúůüùûýÿžþÞĐđßÆa·/_,:;",e=0,n=r.length;e<n;e++)t=t.replace(new RegExp(r.charAt(e),"g"),"AAAAAACCCDEEEEEEEEIIIINNOOOOOORRSTUUUUUYYZaaaaaacccdeeeeeeeeiiiinnooooooorrstuuuuuyyzbBDdBAa------".charAt(e));return t=t.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")},template:i,trim:function(t){return null==t?"":String.prototype.trim.call(t)},uniqueId:function(t){var r=++n+"";return t?t+r:r},upperFirst:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}}}),t("skylark-langx/Xhr",["skylark-langx-xhr"],function(t){return t}),t("skylark-langx/Restful",["./Evented","./objects","./strings","./Xhr"],function(t,r,e,n){var i=r.mixin,a=e.substitute,s=t.inherit({klassName:"Restful",idAttribute:"id",getBaseUrl:function(t){var r=a(this.baseEndpoint,t),e=this.server+this.basePath+r;return void 0!==t[this.idAttribute]&&(e=e+"/"+t[this.idAttribute]),e},_head:function(t){},_get:function(t){return n.get(this.getBaseUrl(t),t)},_post:function(t,r){var e=this.getBaseUrl(t);return r&&(e=e+"/"+r),n.post(e,t)},_put:function(t,r){var e=this.getBaseUrl(t);return r&&(e=e+"/"+r),n.put(e,t)},_delete:function(t){var r=this.getBaseUrl(t);return n.del(r)},_patch:function(t){var r=this.getBaseUrl(t);return n.patch(r,t)},query:function(t){return this._post(t)},retrieve:function(t){return this._get(t)},create:function(t){return this._post(t)},update:function(t){return this._put(t)},delete:function(t){return this._delete(t)},patch:function(t){return this._patch(t)},init:function(t){i(this,t)}});return s}),t("skylark-langx/Stateful",["./Evented","./strings","./objects"],function(t,r,e){var n=e.isEqual,i=e.mixin,a=e.result,s=e.isEmptyObject,u=e.clone,o=r.uniqueId,l=t.inherit({_construct:function(t,r){var e=t||{};r||(r={}),this.cid=o(this.cidPrefix),this.attributes={},r.collection&&(this.collection=r.collection),r.parse&&(e=this.parse(e,r)||{});var n=a(this,"defaults");e=i({},n,e),this.set(e,r),this.changed={}},changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",toJSON:function(t){return u(this.attributes)},get:function(t){return this.attributes[t]},has:function(t){return null!=this.get(t)},set:function(t,r,e){if(null==t)return this;var i;if("object"==typeof t?(i=t,e=r):(i={})[t]=r,e||(e={}),!this._validate(i,e))return!1;var a=e.unset,s=e.silent,o=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=u(this.attributes),this.changed={});var c=this.attributes,f=this.changed,h=this._previousAttributes;for(var d in i)r=i[d],n(c[d],r)||o.push(d),n(h[d],r)?delete f[d]:f[d]=r,a?delete c[d]:c[d]=r;if(this.idAttribute in i&&(this.id=this.get(this.idAttribute)),!s){o.length&&(this._pending=e);for(var p=0;p<o.length;p++)this.trigger("change:"+o[p],this,c[o[p]],e)}if(l)return this;if(!s)for(;this._pending;)e=this._pending,this._pending=!1,this.trigger("change",this,e);return this._pending=!1,this._changing=!1,this},unset:function(t,r){return this.set(t,void 0,i({},r,{unset:!0}))},clear:function(t){var r={};for(var e in this.attributes)r[e]=void 0;return this.set(r,i({},t,{unset:!0}))},hasChanged:function(t){return null==t?!s(this.changed):void 0!==this.changed[t]},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&u(this.changed);var r=this._changing?this._previousAttributes:this.attributes,e={};for(var i in t){var a=t[i];n(r[i],a)||(e[i]=a)}return!s(e)&&e},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return u(this._previousAttributes)},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i({},t,{validate:!0}))},_validate:function(t,r){if(!r.validate||!this.validate)return!0;t=i({},this.attributes,t);var e=this.validationError=this.validate(t,r)||null;return!e||(this.trigger("invalid",this,e,i(r,{validationError:e})),!1)}});return l}),t("skylark-langx/topic",["skylark-langx-topic"],function(t){return t}),t("skylark-langx/types",["skylark-langx-types"],function(t){return t}),t("skylark-langx/langx",["./skylark","./arrays","./ArrayStore","./aspect","./async","./datetimes","./Deferred","./Evented","./funcs","./hoster","./klass","./numbers","./objects","./Restful","./Stateful","./strings","./topic","./types","./Xhr"],function(t,r,e,n,i,a,s,u,o,l,c,f,h,d,p,g,v,x,y){"use strict";Array.prototype.concat,Array.prototype.indexOf,Array.prototype.slice,Array.prototype.filter;var k=h.mixin,b=h.safeMixin,m=x.isFunction;var w=1;function A(){return A}return k(A,{createEvent:function(t,r){var e=new CustomEvent(t,r);return b(e,r)},funcArg:function(t,r,e,n){return m(r)?r.call(t,e,n):r},getQueryParams:function(t){var r=(t=t||window.location.href).split("?"),e={};r.length>1&&r[1].split("&").forEach(function(t){var r=t.split("=");e[r[0]]=r[1]});return e},toPixel:function(t){return parseFloat(t)||0},uid:function(t){return t._uid||(t._uid=w++)},URL:"undefined"!=typeof window?window.URL||window.webkitURL:null}),k(A,r,n,a,o,f,h,g,x,{ArrayStore:e,async:i,Deferred:s,Evented:u,hoster:l,klass:c,Restful:d,Stateful:p,topic:v,Xhr:y}),t.langx=A}),t("skylark-langx/main",["./skylark","./langx"],function(t){return t}),t("skylark-langx",["skylark-langx/main"],function(t){return t})}(e),!i){var u=n("skylark-langx/skylark");a?module.exports=u:r.skylarkjs=u}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-langx.js.map
