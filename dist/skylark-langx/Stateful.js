/**
 * skylark-langx - A simple JavaScript language extension library, including class support, Evented class, Deferred class and some commonly used tool functions.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.5
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./Evented","./strings","./objects"],function(t,i,e){var l=e.isEqual,n=e.mixin,s=e.result,r=e.isEmptyObject,g=e.clone,h=i.uniqueId;return t.inherit({_construct:function(t,i){var t=t||{},e=(i=i||{},this.cid=h(this.cidPrefix),this.attributes={},i.collection&&(this.collection=i.collection),i.parse&&(t=this.parse(t,i)||{}),s(this,"defaults")),t=n({},e,t);this.set(t,i),this.changed={}},changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",toJSON:function(t){return g(this.attributes)},get:function(t){return this.attributes[t]},has:function(t){return null!=this.get(t)},set:function(t,i,e){if(null!=t){var n;if("object"==typeof t?(n=t,e=i):(n={})[t]=i,!this._validate(n,e=e||{}))return!1;var s,r=e.unset,t=e.silent,h=[],u=this._changing,a=(this._changing=!0,u||(this._previousAttributes=g(this.attributes),this.changed={}),this.attributes),o=this.changed,c=this._previousAttributes;for(s in n)i=n[s],l(a[s],i)||h.push(s),l(c[s],i)?delete o[s]:o[s]=i,r?delete a[s]:a[s]=i;if(this.idAttribute in n&&(this.id=this.get(this.idAttribute)),!t){h.length&&(this._pending=e);for(var d=0;d<h.length;d++)this.trigger("change:"+h[d],this,a[h[d]],e)}if(!u){if(!t)for(;this._pending;)e=this._pending,this._pending=!1,this.trigger("change",this,e);this._pending=!1,this._changing=!1}}return this},unset:function(t,i){return this.set(t,void 0,n({},i,{unset:!0}))},clear:function(t){var i,e={};for(i in this.attributes)e[i]=void 0;return this.set(e,n({},t,{unset:!0}))},hasChanged:function(t){return null==t?!r(this.changed):void 0!==this.changed[t]},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&g(this.changed);var i,e=this._changing?this._previousAttributes:this.attributes,n={};for(i in t){var s=t[i];l(e[i],s)||(n[i]=s)}return!r(n)&&n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return g(this._previousAttributes)},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n({},t,{validate:!0}))},_validate:function(t,i){if(!i.validate||!this.validate)return!0;t=n({},this.attributes,t);t=this.validationError=this.validate(t,i)||null;return!t||(this.trigger("invalid",this,t,n(i,{validationError:t})),!1)}})});
//# sourceMappingURL=sourcemaps/Stateful.js.map
