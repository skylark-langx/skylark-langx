/**
 * skylark-langx - A simple JavaScript language extension library, including class support, Evented class, Deferred class and some commonly used tool functions.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.5
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./arrays","./funcs","./objects"],function(t,e,r){"use strict";var n=Symbol?Symbol():"__pglisteners",o=Array.prototype.slice,i=e.proxy,s=t.makeArray,c=r.result,u=r.mixin;u(Promise.prototype,{always:function(t){return this.then(t,t),this},done:function(t){return this.then(t),this},fail:function(t){return this.catch(t),this}});var p=function(){var t=this;h(this.promise=new Promise(function(e,r){t._resolve=e,t._reject=r}),t),this[n]=[]};function h(t,e){var r={state:function(){return e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},then:function(t,e,n){return n&&this.progress(n),u(Promise.prototype.then.call(this,t&&function(e){return e&&void 0!==e.__ctx__?t.apply(e.__ctx__,e):t(e)},e&&function(t){return t&&void 0!==t.__ctx__?e.apply(t.__ctx__,t):e(t)}),r)},progress:function(t){return e[n].push(t),this}};return r.pipe=r.then,u(t,r)}return p.prototype.resolve=function(t){var e=o.call(arguments);return this.resolveWith(null,e)},p.prototype.resolveWith=function(t,e){return(e=e?s(e):[]).__ctx__=t,this._resolve(e),this._resolved=!0,this},p.prototype.progress=function(t){try{return this[n].forEach(function(e){return e(t)})}catch(t){this.reject(t)}return this},p.prototype.reject=function(t){var e=o.call(arguments);return this.rejectWith(null,e)},p.prototype.rejectWith=function(t,e){return(e=e?s(e):[]).__ctx__=t,this._reject(e),this._rejected=!0,this},p.prototype.isResolved=function(){return!!this._resolved},p.prototype.isRejected=function(){return!!this._rejected},p.prototype.then=function(t,e,r){return c(this,"promise").then(t,e,r)},p.prototype.done=p.prototype.then,p.all=function(t){return h(Promise.all(t))},p.first=function(t){return h(Promise.race(t))},p.when=function(t,e,r,n){var o=t&&"function"==typeof t.then,s=o&&t instanceof Promise;if(!o)return arguments.length>1?e?e(t):t:(new p).resolve(t);if(!s){var c=new p(t.cancel);t.then(i(c.resolve,c),i(c.reject,c),c.progress),t=c.promise}return e||r||n?t.then(e,r,n):t},p.reject=function(t){var e=new p;return e.reject(t),e.promise},p.immediate=p.resolve=function(t){var e=new p;return e.resolve.apply(e,arguments),e.promise},p});
//# sourceMappingURL=sourcemaps/Deferred.js.map
