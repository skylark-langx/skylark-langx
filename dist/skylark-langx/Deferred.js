/**
 * skylark-langx - A simple JavaScript language extension library, including class support, Evented class, Deferred class and some commonly used tool functions.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.5
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./arrays","./funcs","./objects"],function(t,e,r){"use strict";var n=Symbol?Symbol():"__pglisteners",o=Symbol?Symbol():"__pgnotifies",i=Array.prototype.slice,s=e.proxy,c=t.makeArray,u=r.result,p=r.mixin;p(Promise.prototype,{always:function(t){return this.then(t,t),this},done:function(){for(var t=0;t<arguments.length;t++)this.then(arguments[t]);return this},fail:function(t){return this.catch(t),this}});var h=function(){var t=this;f(this.promise=new Promise(function(e,r){t._resolve=e,t._reject=r}),t),this[n]=[],this[o]=[]};function f(t,e){var r={state:function(){return e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},then:function(t,e,r){return r&&this.progress(r),f(Promise.prototype.then.call(this,t&&function(e){return e&&void 0!==e.__ctx__?t.apply(e.__ctx__,e):t(e)},e&&function(t){return t&&void 0!==t.__ctx__?e.apply(t.__ctx__,t):e(t)}))},progress:function(t){return e[o].forEach(function(e){t(e)}),e[n].push(t),this}};return r.pipe=r.then,p(t,r)}return h.prototype.resolve=function(t){var e=i.call(arguments);return this.resolveWith(null,e)},h.prototype.resolveWith=function(t,e){return(e=e?c(e):[]).__ctx__=t,this._resolve(e),this._resolved=!0,this},h.prototype.notify=function(t){try{return this[o].push(t),this[n].forEach(function(e){return e(t)})}catch(t){this.reject(t)}return this},h.prototype.reject=function(t){var e=i.call(arguments);return this.rejectWith(null,e)},h.prototype.rejectWith=function(t,e){return(e=e?c(e):[]).__ctx__=t,this._reject(e),this._rejected=!0,this},h.prototype.isResolved=function(){return!!this._resolved},h.prototype.isRejected=function(){return!!this._rejected},h.prototype.then=function(t,e,r){return u(this,"promise").then(t,e,r)},h.prototype.progress=function(t){return u(this,"promise").progress(t)},h.prototype.catch=function(t){return u(this,"promise").catch(t)},h.prototype.done=function(){var t=u(this,"promise");return t.done.apply(t,arguments)},h.prototype.fail=function(t){return u(this,"promise").fail(t)},h.all=function(t){var e=new h;return Promise.all(t).then(e.resolve.bind(e),e.reject.bind(e)),u(e,"promise")},h.first=function(t){return f(Promise.race(t))},h.when=function(t,e,r,n){var o=t&&"function"==typeof t.then,i=o&&t instanceof Promise;if(!o)return arguments.length>1?e?e(t):t:(new h).resolve(t);if(!i){var c=new h(t.cancel);t.then(s(c.resolve,c),s(c.reject,c),c.notify),t=c.promise}return e||r||n?t.then(e,r,n):t},h.reject=function(t){var e=new h;return e.reject(t),e.promise},h.immediate=h.resolve=function(t){var e=new h;return e.resolve.apply(e,arguments),e.promise},h});
//# sourceMappingURL=sourcemaps/Deferred.js.map
