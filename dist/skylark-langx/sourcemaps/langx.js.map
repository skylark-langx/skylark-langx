{"version":3,"sources":["langx.js"],"names":["define","skylark","advise","dispatcher","type","advice","receiveArguments","signal","previous","around","advised","this","arguments","remove","target","args","apply","next","id","nextId","aspect","methodName","existing","executionId","before","results","after","newResults","undefined","call","clone","src","checkCloneMethod","copy","isArray","i","length","push","isPlainObject","key","createEvent","props","e","CustomEvent","safeMixin","debounce","fn","wait","timeout","later","clearTimeout","setTimeout","compact","array","filter","item","dasherize","str","replace","toLowerCase","deserializeValue","value","test","JSON","parse","each","obj","callback","undef","hasOwnProperty","flatten","isArrayLike","result","j","funcArg","context","arg","idx","payload","isFunction","getQueryParams","url","window","location","href","segs","split","params","forEach","queryParam","nv","inArray","indexOf","object","constructor","Array","isString","isHtmlNode","isBoolean","isDocument","nodeType","DOCUMENT_NODE","isEqual","a","b","eq","isObject","isWindow","Object","getPrototypeOf","prototype","isDefined","Node","isNumber","isSameOrigin","origin","protocol","hostname","port","startsWith","isEmptyObject","name","makeArray","offset","startWith","concat","slice","map","elements","values","nextTick","requestAnimationFrame","proxy","proxyFn","unshift","TypeError","toPixel","parseFloat","trim","String","removeItem","items","splice","_mixin","source","deep","safe","_parseMixinArgs","shift","pop","sources","mixin","path","fallback","prop","substitute","template","transform","thisObject","getObject","match","retVal","getValue","keys","_k","reverse","v","format","toString","uid","_uid","uniq","uniqueId","prefix","idCounter","langx","createClass","extendClass","ctor","options","proto","_super","superclass","noOverrided","_constructor","superFn","tmp","overrided","ret","parent","init","klassName","Function","create","__proto__","partial","inherit","delegate","TMP","PGLISTENERS","Symbol","Deferred","self","p","promise","Promise","resolve","reject","_resolve","_reject","then","onResolved","onRejected","onProgress","progress","done","handler","fail","bind","listener","error","reason","errback","progback","all","first","race","when","valueOrPromise","receivedPromise","nativePromise","deferred","cancel","err","d","data","immediate","deepEq","Evented","on","events","selector","ctx","one","_hub","trigger","eventName","listeners","len","reCompact","listened","event","evtArr","_events","listenTo","listening","listeningTo","_listeningTo","listeningEvents","listeningEvent","listenToOnce","off","evts","liveEvents","_","unlistenTo","SymbolProto","document","createElement","aStack","bStack","className","valueOf","areArrays","aCtor","bCtor","class2type","Stateful","attributes","attrs","cid","cidPrefix","collection","defaults","set","changed","validationError","idAttribute","toJSON","get","attr","has","val","_validate","unset","silent","changes","changing","_changing","_previousAttributes","current","prev","_pending","clear","hasChanged","changedAttributes","diff","old","previousAttributes","isNew","isValid","validate","camelCase","toUpperCase","klass","lowerFirst","charAt","returnTrue","returnFalse","serializeValue","stringify","upperFirst","URL","webkitURL"],"mappings":"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","file":"../langx.js","sourcesContent":["define([\"./skylark\"], function(skylark) {\r\n    var toString = {}.toString,\r\n        concat = Array.prototype.concat,\r\n        indexOf = Array.prototype.indexOf,\r\n        slice = Array.prototype.slice,\r\n        filter = Array.prototype.filter;\r\n\r\n    var undefined, nextId = 0;\r\n    function advise(dispatcher, type, advice, receiveArguments){\r\n        var previous = dispatcher[type];\r\n        var around = type == \"around\";\r\n        var signal;\r\n        if(around){\r\n            var advised = advice(function(){\r\n                return previous.advice(this, arguments);\r\n            });\r\n            signal = {\r\n                remove: function(){\r\n                    if(advised){\r\n                        advised = dispatcher = advice = null;\r\n                    }\r\n                },\r\n                advice: function(target, args){\r\n                    return advised ?\r\n                        advised.apply(target, args) :  // called the advised function\r\n                        previous.advice(target, args); // cancelled, skip to next one\r\n                }\r\n            };\r\n        }else{\r\n            // create the remove handler\r\n            signal = {\r\n                remove: function(){\r\n                    if(signal.advice){\r\n                        var previous = signal.previous;\r\n                        var next = signal.next;\r\n                        if(!next && !previous){\r\n                            delete dispatcher[type];\r\n                        }else{\r\n                            if(previous){\r\n                                previous.next = next;\r\n                            }else{\r\n                                dispatcher[type] = next;\r\n                            }\r\n                            if(next){\r\n                                next.previous = previous;\r\n                            }\r\n                        }\r\n\r\n                        // remove the advice to signal that this signal has been removed\r\n                        dispatcher = advice = signal.advice = null;\r\n                    }\r\n                },\r\n                id: nextId++,\r\n                advice: advice,\r\n                receiveArguments: receiveArguments\r\n            };\r\n        }\r\n        if(previous && !around){\r\n            if(type == \"after\"){\r\n                // add the listener to the end of the list\r\n                // note that we had to change this loop a little bit to workaround a bizarre IE10 JIT bug\r\n                while(previous.next && (previous = previous.next)){}\r\n                previous.next = signal;\r\n                signal.previous = previous;\r\n            }else if(type == \"before\"){\r\n                // add to beginning\r\n                dispatcher[type] = signal;\r\n                signal.next = previous;\r\n                previous.previous = signal;\r\n            }\r\n        }else{\r\n            // around or first one just replaces\r\n            dispatcher[type] = signal;\r\n        }\r\n        return signal;\r\n    }\r\n    function aspect(type){\r\n        return function(target, methodName, advice, receiveArguments){\r\n            var existing = target[methodName], dispatcher;\r\n            if(!existing || existing.target != target){\r\n                // no dispatcher in place\r\n                target[methodName] = dispatcher = function(){\r\n                    var executionId = nextId;\r\n                    // before advice\r\n                    var args = arguments;\r\n                    var before = dispatcher.before;\r\n                    while(before){\r\n                        args = before.advice.apply(this, args) || args;\r\n                        before = before.next;\r\n                    }\r\n                    // around advice\r\n                    if(dispatcher.around){\r\n                        var results = dispatcher.around.advice(this, args);\r\n                    }\r\n                    // after advice\r\n                    var after = dispatcher.after;\r\n                    while(after && after.id < executionId){\r\n                        if(after.receiveArguments){\r\n                            var newResults = after.advice.apply(this, args);\r\n                            // change the return value only if a new value was returned\r\n                            results = newResults === undefined ? results : newResults;\r\n                        }else{\r\n                            results = after.advice.call(this, results, args);\r\n                        }\r\n                        after = after.next;\r\n                    }\r\n                    return results;\r\n                };\r\n                if(existing){\r\n                    dispatcher.around = {advice: function(target, args){\r\n                        return existing.apply(target, args);\r\n                    }};\r\n                }\r\n                dispatcher.target = target;\r\n            }\r\n            var results = advise((dispatcher || existing), type, advice, receiveArguments);\r\n            advice = null;\r\n            return results;\r\n        };\r\n    }\r\n\r\n\r\n    var createClass = (function() {\r\n        function extendClass(ctor, props, options) {\r\n            // Copy the properties to the prototype of the class.\r\n            var proto = ctor.prototype,\r\n                _super = ctor.superclass.prototype,\r\n                noOverrided = options && options.noOverrided;\r\n\r\n            for (var name in props) {\r\n                if (name === \"constructor\") {\r\n                    continue;\r\n                }\r\n\r\n                // Check if we're overwriting an existing function\r\n              proto[name] = typeof props[name] == \"function\" && !props[name]._constructor && !noOverrided && typeof _super[name] == \"function\" ?\r\n                      (function(name, fn, superFn) {\r\n                        return function() {\r\n                            var tmp = this.overrided;\r\n\r\n                            // Add a new ._super() method that is the same method\r\n                            // but on the super-class\r\n                            this.overrided = superFn;\r\n\r\n                            // The method only need to be bound temporarily, so we\r\n                            // remove it when we're done executing\r\n                            var ret = fn.apply(this, arguments);\r\n\r\n                            this.overrided = tmp;\r\n\r\n                            return ret;\r\n                        };\r\n                    })(name, props[name], _super[name]) :\r\n                    props[name];\r\n            }\r\n\r\n            return ctor;\r\n        }\r\n\r\n        return function createClass(props, parent, options) {\r\n\r\n            var _constructor = props.constructor;\r\n            if (_constructor === Object) {\r\n                _constructor = function() {\r\n                    if (this.init) {\r\n                        return this.init.apply(this, arguments);\r\n                    }\r\n                };\r\n            };\r\n\r\n            var klassName = props.klassName || \"\",\r\n                ctor = new Function(\r\n                    \"return function \" + klassName + \"() {\" +\r\n                    \"var inst = this,\" +\r\n                    \" ctor = arguments.callee;\" +\r\n                    \"if (!(inst instanceof ctor)) {\" +\r\n                    \"inst = Object.create(ctor.prototype);\" +\r\n                    \"}\" +\r\n                    \"return ctor._constructor.apply(inst, arguments) || inst;\" + \r\n                    \"}\"\r\n                )();\r\n            ctor._constructor = _constructor;\r\n            parent = parent || Object;\r\n            // Populate our constructed prototype object\r\n            ctor.prototype = Object.create(parent.prototype);\r\n\r\n            // Enforce the constructor to be what we expect\r\n            ctor.prototype.constructor = ctor;\r\n            ctor.superclass = parent;\r\n\r\n            // And make this class extendable\r\n            ctor.__proto__ = parent;\r\n\r\n            if (!ctor.partial) {\r\n                ctor.partial = function(props, options) {\r\n                    return extendClass(this, props, options);\r\n                };\r\n            }\r\n            if (!ctor.inherit) {\r\n                ctor.inherit = function(props, options) {\r\n                    return createClass(props, this, options);\r\n                };\r\n            }\r\n\r\n            ctor.partial(props, options);\r\n\r\n            return ctor;\r\n        }\r\n    })();\r\n\r\n\r\n    function clone( /*anything*/ src,checkCloneMethod) {\r\n        var copy;\r\n        if (src === undefined || src === null) {\r\n            copy = src;\r\n        } else if (checkCloneMethod && src.clone) {\r\n            copy = src.clone();\r\n        } else if (isArray(src)) {\r\n            copy = [];\r\n            for (var i = 0; i < src.length; i++) {\r\n                copy.push(clone(src[i]));\r\n            }\r\n        } else if (isPlainObject(src)) {\r\n            copy = {};\r\n            for (var key in src) {\r\n                copy[key] = clone(src[key]);\r\n            }\r\n        } else {\r\n            copy = src;\r\n        }\r\n\r\n        return copy;\r\n\r\n    }\r\n\r\n    function createEvent(type, props) {\r\n        var e = new CustomEvent(type, props);\r\n        return safeMixin(e, props);\r\n    }\r\n    \r\n    function debounce(fn, wait) {\r\n        var timeout,\r\n            args,\r\n            later = function() {\r\n                fn.apply(null, args);\r\n            };\r\n\r\n        return function() {\r\n            args = arguments;\r\n            clearTimeout(timeout);\r\n            timeout = setTimeout(later, wait);\r\n        };\r\n    }\r\n\r\n    var delegate = (function() {\r\n        // boodman/crockford delegation w/ cornford optimization\r\n        function TMP() {}\r\n        return function(obj, props) {\r\n            TMP.prototype = obj;\r\n            var tmp = new TMP();\r\n            TMP.prototype = null;\r\n            if (props) {\r\n                mixin(tmp, props);\r\n            }\r\n            return tmp; // Object\r\n        };\r\n    })();\r\n\r\n    var  PGLISTENERS = Symbol ? Symbol() : '__pglisteners';\r\n\r\n    var Deferred = function() {\r\n        var self = this,\r\n            p = this.promise = new Promise(function(resolve, reject) {\r\n                self._resolve = resolve;\r\n                self._reject = reject;\r\n            });\r\n\r\n        mixin(p,{\r\n            then : function(onResolved,onRejected,onProgress) {\r\n                if (onProgress) {\r\n                    this.progress(onProgress);\r\n                }\r\n                return Promise.prototype.then.call(this,onResolved,onRejected);\r\n            },\r\n            done : function(handler) {\r\n                return Promise.prototype.then.call(this,handler);\r\n            },\r\n            fail : function(handler) { \r\n                return Promise.prototype.catch.call(this,handler);\r\n            }, \r\n            progress : function(handler) {\r\n                self[PGLISTENERS].push(handler);\r\n                return this;\r\n            }\r\n\r\n        });\r\n\r\n        this[PGLISTENERS] = [];\r\n\r\n        this.resolve = Deferred.prototype.resolve.bind(this);\r\n        this.reject = Deferred.prototype.reject.bind(this);\r\n        this.progress = Deferred.prototype.progress.bind(this);\r\n\r\n    };\r\n\r\n    Deferred.prototype.resolve = function(value) {\r\n        this._resolve.call(this.promise, value);\r\n        return this;\r\n    };\r\n\r\n    Deferred.prototype.progress = function(value) {\r\n        try {\r\n          return this[PGLISTENERS].forEach(function (listener) {\r\n            return listener(value);\r\n          });\r\n        } catch (error) {\r\n          this.reject(error);\r\n        }\r\n        return this;\r\n    };\r\n\r\n    Deferred.prototype.reject = function(reason) {\r\n        this._reject.call(this.promise, reason);\r\n        return this;\r\n    };\r\n\r\n\r\n    Deferred.prototype.then = function(callback, errback, progback) {\r\n        return this.promise.then(callback, errback, progback);\r\n    };\r\n\r\n    Deferred.all = function(array) {\r\n        return Promise.all(array);\r\n    };\r\n\r\n    Deferred.first = function(array) {\r\n        return Promise.race(array);\r\n    };\r\n\r\n    Deferred.when = function(valueOrPromise, callback, errback, progback) {\r\n        var receivedPromise = valueOrPromise && typeof valueOrPromise.then === \"function\";\r\n        var nativePromise = receivedPromise && valueOrPromise instanceof Promise;\r\n\r\n        if (!receivedPromise) {\r\n            if (arguments.length > 1) {\r\n                return callback ? callback(valueOrPromise) : valueOrPromise;\r\n            } else {\r\n                return new Deferred().resolve(valueOrPromise);\r\n            }\r\n        } else if (!nativePromise) {\r\n            var deferred = new Deferred(valueOrPromise.cancel);\r\n            valueOrPromise.then(deferred.resolve, deferred.reject, deferred.progress);\r\n            valueOrPromise = deferred.promise;\r\n        }\r\n\r\n        if (callback || errback || progback) {\r\n            return valueOrPromise.then(callback, errback, progback);\r\n        }\r\n        return valueOrPromise;\r\n    };\r\n\r\n    Deferred.reject = function(err) {\r\n        var d = new Deferred();\r\n        d.reject(err);\r\n        return d.promise;\r\n    };\r\n\r\n    Deferred.resolve = function(data) {\r\n        var d = new Deferred();\r\n        d.resolve(data);\r\n        return d.promise;\r\n    };\r\n\r\n    Deferred.immediate = Deferred.resolve;\r\n\r\n    var Evented = createClass({\r\n        on: function(events, selector, data, callback, ctx, /*used internally*/ one) {\r\n            var self = this,\r\n                _hub = this._hub || (this._hub = {});\r\n\r\n            if (isPlainObject(events)) {\r\n                ctx = callback;\r\n                each(events, function(type, fn) {\r\n                    self.on(type, selector, data, fn, ctx, one);\r\n                });\r\n                return this;\r\n            }\r\n\r\n            if (!isString(selector) && !isFunction(callback)) {\r\n                ctx = callback;\r\n                callback = data;\r\n                data = selector;\r\n                selector = undefined;\r\n            }\r\n\r\n            if (isFunction(data)) {\r\n                ctx = callback;\r\n                callback = data;\r\n                data = null;\r\n            }\r\n\r\n            if (isString(events)) {\r\n                events = events.split(/\\s/)\r\n            }\r\n\r\n            events.forEach(function(name) {\r\n                (_hub[name] || (_hub[name] = [])).push({\r\n                    fn: callback,\r\n                    selector: selector,\r\n                    data: data,\r\n                    ctx: ctx,\r\n                    one: one\r\n                });\r\n            });\r\n\r\n            return this;\r\n        },\r\n\r\n        one: function(events, selector, data, callback, ctx) {\r\n            return this.on(events, selector, data, callback, ctx, 1);\r\n        },\r\n\r\n        trigger: function(e /*,argument list*/ ) {\r\n            if (!this._hub) {\r\n                return this;\r\n            }\r\n\r\n            var self = this;\r\n\r\n            if (isString(e)) {\r\n                e = new CustomEvent(e);\r\n            }\r\n\r\n            e.target = this;\r\n\r\n            var args = slice.call(arguments, 1);\r\n            if (isDefined(args)) {\r\n                args = [e].concat(args);\r\n            } else {\r\n                args = [e];\r\n            }\r\n            [e.type || e.name, \"all\"].forEach(function(eventName) {\r\n                var listeners = self._hub[eventName];\r\n                if (!listeners) {\r\n                    return;\r\n                }\r\n\r\n                var len = listeners.length,\r\n                    reCompact = false;\r\n\r\n                for (var i = 0; i < len; i++) {\r\n                    var listener = listeners[i];\r\n                    if (e.data) {\r\n                        if (listener.data) {\r\n                            e.data = mixin({}, listener.data, e.data);\r\n                        }\r\n                    } else {\r\n                        e.data = listener.data || null;\r\n                    }\r\n                    listener.fn.apply(listener.ctx, args);\r\n                    if (listener.one) {\r\n                        listeners[i] = null;\r\n                        reCompact = true;\r\n                    }\r\n                }\r\n\r\n                if (reCompact) {\r\n                    self._hub[eventName] = compact(listeners);\r\n                }\r\n\r\n            });\r\n            return this;\r\n        },\r\n\r\n        listened: function(event) {\r\n            var evtArr = ((this._hub || (this._events = {}))[event] || []);\r\n            return evtArr.length > 0;\r\n        },\r\n\r\n        listenTo: function(obj, event, callback, /*used internally*/ one) {\r\n            if (!obj) {\r\n                return this;\r\n            }\r\n\r\n            // Bind callbacks on obj,\r\n            if (isString(callback)) {\r\n                callback = this[callback];\r\n            }\r\n\r\n            if (one) {\r\n                obj.one(event, callback, this);\r\n            } else {\r\n                obj.on(event, callback, this);\r\n            }\r\n\r\n            //keep track of them on listening.\r\n            var listeningTo = this._listeningTo || (this._listeningTo = []),\r\n                listening;\r\n\r\n            for (var i = 0; i < listeningTo.length; i++) {\r\n                if (listeningTo[i].obj == obj) {\r\n                    listening = listeningTo[i];\r\n                    break;\r\n                }\r\n            }\r\n            if (!listening) {\r\n                listeningTo.push(\r\n                    listening = {\r\n                        obj: obj,\r\n                        events: {}\r\n                    }\r\n                );\r\n            }\r\n            var listeningEvents = listening.events,\r\n                listeningEvent = listeningEvents[event] = listeningEvents[event] || [];\r\n            if (listeningEvent.indexOf(callback) == -1) {\r\n                listeningEvent.push(callback);\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        listenToOnce: function(obj, event, callback) {\r\n            return this.listenTo(obj, event, callback, 1);\r\n        },\r\n\r\n        off: function(events, callback) {\r\n            var _hub = this._hub || (this._hub = {});\r\n            if (isString(events)) {\r\n                events = events.split(/\\s/)\r\n            }\r\n\r\n            events.forEach(function(name) {\r\n                var evts = _hub[name];\r\n                var liveEvents = [];\r\n\r\n                if (evts && callback) {\r\n                    for (var i = 0, len = evts.length; i < len; i++) {\r\n                        if (evts[i].fn !== callback && evts[i].fn._ !== callback)\r\n                            liveEvents.push(evts[i]);\r\n                    }\r\n                }\r\n\r\n                if (liveEvents.length) {\r\n                    _hub[name] = liveEvents;\r\n                } else {\r\n                    delete _hub[name];\r\n                }\r\n            });\r\n\r\n            return this;\r\n        },\r\n        unlistenTo: function(obj, event, callback) {\r\n            var listeningTo = this._listeningTo;\r\n            if (!listeningTo) {\r\n                return this;\r\n            }\r\n            for (var i = 0; i < listeningTo.length; i++) {\r\n                var listening = listeningTo[i];\r\n\r\n                if (obj && obj != listening.obj) {\r\n                    continue;\r\n                }\r\n\r\n                var listeningEvents = listening.events;\r\n                for (var eventName in listeningEvents) {\r\n                    if (event && event != eventName) {\r\n                        continue;\r\n                    }\r\n\r\n                    listeningEvent = listeningEvents[eventName];\r\n\r\n                    for (var j = 0; j < listeningEvent.length; j++) {\r\n                        if (!callback || callback == listeningEvent[i]) {\r\n                            listening.obj.off(eventName, listeningEvent[i], this);\r\n                            listeningEvent[i] = null;\r\n                        }\r\n                    }\r\n\r\n                    listeningEvent = listeningEvents[eventName] = compact(listeningEvent);\r\n\r\n                    if (isEmptyObject(listeningEvent)) {\r\n                        listeningEvents[eventName] = null;\r\n                    }\r\n\r\n                }\r\n\r\n                if (isEmptyObject(listeningEvents)) {\r\n                    listeningTo[i] = null;\r\n                }\r\n            }\r\n\r\n            listeningTo = this._listeningTo = compact(listeningTo);\r\n            if (isEmptyObject(listeningTo)) {\r\n                this._listeningTo = null;\r\n            }\r\n\r\n            return this;\r\n        }\r\n    });\r\n\r\n    \r\n    function compact(array) {\r\n        return filter.call(array, function(item) {\r\n            return item != null;\r\n        });\r\n    }\r\n\r\n    function dasherize(str) {\r\n        return str.replace(/::/g, '/')\r\n            .replace(/([A-Z]+)([A-Z][a-z])/g, '$1_$2')\r\n            .replace(/([a-z\\d])([A-Z])/g, '$1_$2')\r\n            .replace(/_/g, '-')\r\n            .toLowerCase();\r\n    }\r\n\r\n    function deserializeValue(value) {\r\n        try {\r\n            return value ?\r\n                value == \"true\" ||\r\n                (value == \"false\" ? false :\r\n                    value == \"null\" ? null :\r\n                    +value + \"\" == value ? +value :\r\n                    /^[\\[\\{]/.test(value) ? JSON.parse(value) :\r\n                    value) : value;\r\n        } catch (e) {\r\n            return value;\r\n        }\r\n    }\r\n\r\n    function each(obj, callback) {\r\n        var length, key, i, undef, value;\r\n\r\n        if (obj) {\r\n            length = obj.length;\r\n\r\n            if (length === undef) {\r\n                // Loop object items\r\n                for (key in obj) {\r\n                    if (obj.hasOwnProperty(key)) {\r\n                        value = obj[key];\r\n                        if (callback.call(value, key, value) === false) {\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                // Loop array items\r\n                for (i = 0; i < length; i++) {\r\n                    value = obj[i];\r\n                    if (callback.call(value, i, value) === false) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    function flatten(array) {\r\n        if (isArrayLike(array)) {\r\n            var result = [];\r\n            for (var i = 0; i < array.length; i++) {\r\n                var item = array[i];\r\n                if (isArrayLike(item)) {\r\n                    for (var j = 0; j < item.length; j++) {\r\n                        result.push(item[j]);\r\n                    }\r\n                } else {\r\n                    result.push(item);\r\n                }\r\n            }\r\n            return result;\r\n        } else {\r\n            return array;\r\n        }\r\n        //return array.length > 0 ? concat.apply([], array) : array;\r\n    }\r\n\r\n    function funcArg(context, arg, idx, payload) {\r\n        return isFunction(arg) ? arg.call(context, idx, payload) : arg;\r\n    }\r\n\r\n    var getAbsoluteUrl = (function() {\r\n        var a;\r\n\r\n        return function(url) {\r\n            if (!a) a = document.createElement('a');\r\n            a.href = url;\r\n\r\n            return a.href;\r\n        };\r\n    })();\r\n\r\n    function getQueryParams(url) {\r\n        var url = url || window.location.href,\r\n            segs = url.split(\"?\"),\r\n            params = {};\r\n\r\n        if (segs.length > 1) {\r\n            segs[1].split(\"&\").forEach(function(queryParam) {\r\n                var nv = queryParam.split('=');\r\n                params[nv[0]] = nv[1];\r\n            });\r\n        }\r\n        return params;\r\n    }\r\n\r\n    function grep(array, callback) {\r\n        var out = [];\r\n\r\n        each(array, function(i, item) {\r\n            if (callback(item, i)) {\r\n                out.push(item);\r\n            }\r\n        });\r\n\r\n        return out;\r\n    }\r\n\r\n    function inArray(item, array) {\r\n        if (!array) {\r\n            return -1;\r\n        }\r\n        var i;\r\n\r\n        if (array.indexOf) {\r\n            return array.indexOf(item);\r\n        }\r\n\r\n        i = array.length;\r\n        while (i--) {\r\n            if (array[i] === item) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        return -1;\r\n    }\r\n\r\n    function inherit(ctor, base) {\r\n        var f = function() {};\r\n        f.prototype = base.prototype;\r\n\r\n        ctor.prototype = new f();\r\n    }\r\n\r\n    function isArray(object) {\r\n        return object && object.constructor === Array;\r\n    }\r\n\r\n    function isArrayLike(obj) {\r\n        return !isString(obj) && !isHtmlNode(obj) && typeof obj.length == 'number';\r\n    }\r\n\r\n    function isBoolean(obj) {\r\n        return typeof(obj) === \"boolean\";\r\n    }\r\n\r\n    function isDocument(obj) {\r\n        return obj != null && obj.nodeType == obj.DOCUMENT_NODE;\r\n    }\r\n\r\n\r\n  // Internal recursive comparison function for `isEqual`.\r\n  var eq, deepEq;\r\n  var SymbolProto = typeof Symbol !== 'undefined' ? Symbol.prototype : null;\r\n\r\n  eq = function(a, b, aStack, bStack) {\r\n    // Identical objects are equal. `0 === -0`, but they aren't identical.\r\n    // See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).\r\n    if (a === b) return a !== 0 || 1 / a === 1 / b;\r\n    // `null` or `undefined` only equal to itself (strict comparison).\r\n    if (a == null || b == null) return false;\r\n    // `NaN`s are equivalent, but non-reflexive.\r\n    if (a !== a) return b !== b;\r\n    // Exhaust primitive checks\r\n    var type = typeof a;\r\n    if (type !== 'function' && type !== 'object' && typeof b != 'object') return false;\r\n    return deepEq(a, b, aStack, bStack);\r\n  };\r\n\r\n  // Internal recursive comparison function for `isEqual`.\r\n  deepEq = function(a, b, aStack, bStack) {\r\n    // Unwrap any wrapped objects.\r\n    //if (a instanceof _) a = a._wrapped;\r\n    //if (b instanceof _) b = b._wrapped;\r\n    // Compare `[[Class]]` names.\r\n    var className = toString.call(a);\r\n    if (className !== toString.call(b)) return false;\r\n    switch (className) {\r\n      // Strings, numbers, regular expressions, dates, and booleans are compared by value.\r\n      case '[object RegExp]':\r\n      // RegExps are coerced to strings for comparison (Note: '' + /a/i === '/a/i')\r\n      case '[object String]':\r\n        // Primitives and their corresponding object wrappers are equivalent; thus, `\"5\"` is\r\n        // equivalent to `new String(\"5\")`.\r\n        return '' + a === '' + b;\r\n      case '[object Number]':\r\n        // `NaN`s are equivalent, but non-reflexive.\r\n        // Object(NaN) is equivalent to NaN.\r\n        if (+a !== +a) return +b !== +b;\r\n        // An `egal` comparison is performed for other numeric values.\r\n        return +a === 0 ? 1 / +a === 1 / b : +a === +b;\r\n      case '[object Date]':\r\n      case '[object Boolean]':\r\n        // Coerce dates and booleans to numeric primitive values. Dates are compared by their\r\n        // millisecond representations. Note that invalid dates with millisecond representations\r\n        // of `NaN` are not equivalent.\r\n        return +a === +b;\r\n      case '[object Symbol]':\r\n        return SymbolProto.valueOf.call(a) === SymbolProto.valueOf.call(b);\r\n    }\r\n\r\n    var areArrays = className === '[object Array]';\r\n    if (!areArrays) {\r\n      if (typeof a != 'object' || typeof b != 'object') return false;\r\n\r\n      // Objects with different constructors are not equivalent, but `Object`s or `Array`s\r\n      // from different frames are.\r\n      var aCtor = a.constructor, bCtor = b.constructor;\r\n      if (aCtor !== bCtor && !(isFunction(aCtor) && aCtor instanceof aCtor &&\r\n                               isFunction(bCtor) && bCtor instanceof bCtor)\r\n                          && ('constructor' in a && 'constructor' in b)) {\r\n        return false;\r\n      }\r\n    }\r\n    // Assume equality for cyclic structures. The algorithm for detecting cyclic\r\n    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.\r\n\r\n    // Initializing stack of traversed objects.\r\n    // It's done here since we only need them for objects and arrays comparison.\r\n    aStack = aStack || [];\r\n    bStack = bStack || [];\r\n    var length = aStack.length;\r\n    while (length--) {\r\n      // Linear search. Performance is inversely proportional to the number of\r\n      // unique nested structures.\r\n      if (aStack[length] === a) return bStack[length] === b;\r\n    }\r\n\r\n    // Add the first object to the stack of traversed objects.\r\n    aStack.push(a);\r\n    bStack.push(b);\r\n\r\n    // Recursively compare objects and arrays.\r\n    if (areArrays) {\r\n      // Compare array lengths to determine if a deep comparison is necessary.\r\n      length = a.length;\r\n      if (length !== b.length) return false;\r\n      // Deep compare the contents, ignoring non-numeric properties.\r\n      while (length--) {\r\n        if (!eq(a[length], b[length], aStack, bStack)) return false;\r\n      }\r\n    } else {\r\n      // Deep compare objects.\r\n      var keys = Object.keys(a), key;\r\n      length = keys.length;\r\n      // Ensure that both objects contain the same number of properties before comparing deep equality.\r\n      if (Object.keys(b).length !== length) return false;\r\n      while (length--) {\r\n        // Deep compare each member\r\n        key = keys[length];\r\n        if (!(b[key]!==undefined && eq(a[key], b[key], aStack, bStack))) return false;\r\n      }\r\n    }\r\n    // Remove the first object from the stack of traversed objects.\r\n    aStack.pop();\r\n    bStack.pop();\r\n    return true;\r\n  };\r\n\r\n  // Perform a deep comparison to check if two objects are equal.\r\n    function isEqual(a, b) {\r\n        return eq(a, b);\r\n    }\r\n\r\n    function isFunction(value) {\r\n        return type(value) == \"function\";\r\n    }\r\n\r\n    function isObject(obj) {\r\n        return type(obj) == \"object\";\r\n    }\r\n\r\n    function isPlainObject(obj) {\r\n        return isObject(obj) && !isWindow(obj) && Object.getPrototypeOf(obj) == Object.prototype;\r\n    }\r\n\r\n    function isString(obj) {\r\n        return typeof obj === 'string';\r\n    }\r\n\r\n    function isWindow(obj) {\r\n        return obj && obj == obj.window;\r\n    }\r\n\r\n    function isDefined(obj) {\r\n        return typeof obj !== 'undefined';\r\n    }\r\n\r\n    function isHtmlNode(obj) {\r\n        return obj && (obj instanceof Node);\r\n    }\r\n\r\n    function isNumber(obj) {\r\n        return typeof obj == 'number';\r\n    }\r\n\r\n    function isSameOrigin(href) {\r\n        if (href) {\r\n            var origin = location.protocol + '//' + location.hostname;\r\n            if (location.port) {\r\n                origin += ':' + location.port;\r\n            }\r\n            return href.startsWith(origin);\r\n        }\r\n    }\r\n\r\n\r\n    function isEmptyObject(obj) {\r\n        var name;\r\n        for (name in obj) {\r\n            if (obj[name] !== null) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    function makeArray(obj, offset, startWith) {\r\n       if (isArrayLike(obj) ) {\r\n        return (startWith || []).concat(Array.prototype.slice.call(obj, offset || 0));\r\n      }\r\n\r\n      // array of single index\r\n      return [ obj ];             \r\n    }\r\n\r\n    function map(elements, callback) {\r\n        var value, values = [],\r\n            i, key\r\n        if (isArrayLike(elements))\r\n            for (i = 0; i < elements.length; i++) {\r\n                value = callback.call(elements[i], elements[i], i);\r\n                if (value != null) values.push(value)\r\n            }\r\n        else\r\n            for (key in elements) {\r\n                value = callback.call(elements[key], elements[key], key);\r\n                if (value != null) values.push(value)\r\n            }\r\n        return flatten(values)\r\n    }\r\n\r\n    function nextTick(fn) {\r\n        requestAnimationFrame(fn);\r\n        return this;\r\n    }\r\n\r\n    function proxy(fn, context) {\r\n        var args = (2 in arguments) && slice.call(arguments, 2)\r\n        if (isFunction(fn)) {\r\n            var proxyFn = function() {\r\n                return fn.apply(context, args ? args.concat(slice.call(arguments)) : arguments);\r\n            }\r\n            return proxyFn;\r\n        } else if (isString(context)) {\r\n            if (args) {\r\n                args.unshift(fn[context], fn)\r\n                return proxy.apply(null, args)\r\n            } else {\r\n                return proxy(fn[context], fn);\r\n            }\r\n        } else {\r\n            throw new TypeError(\"expected function\");\r\n        }\r\n    }\r\n\r\n\r\n    function toPixel(value) {\r\n        // style values can be floats, client code may want\r\n        // to round for integer pixels.\r\n        return parseFloat(value) || 0;\r\n    }\r\n\r\n    var type = (function() {\r\n        var class2type = {};\r\n\r\n        // Populate the class2type map\r\n        each(\"Boolean Number String Function Array Date RegExp Object Error\".split(\" \"), function(i, name) {\r\n            class2type[\"[object \" + name + \"]\"] = name.toLowerCase();\r\n        });\r\n\r\n        return function type(obj) {\r\n            return obj == null ? String(obj) :\r\n                class2type[toString.call(obj)] || \"object\";\r\n        };\r\n    })();\r\n\r\n    function trim(str) {\r\n        return str == null ? \"\" : String.prototype.trim.call(str);\r\n    }\r\n\r\n    function removeItem(items, item) {\r\n        if (isArray(items)) {\r\n            var idx = items.indexOf(item);\r\n            if (idx != -1) {\r\n                items.splice(idx, 1);\r\n            }\r\n        } else if (isPlainObject(items)) {\r\n            for (var key in items) {\r\n                if (items[key] == item) {\r\n                    delete items[key];\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    function _mixin(target, source, deep, safe) {\r\n        for (var key in source) {\r\n            if (!source.hasOwnProperty(key)) {\r\n                continue;\r\n            }\r\n            if (safe && target[key] !== undefined) {\r\n                continue;\r\n            }\r\n            if (deep && (isPlainObject(source[key]) || isArray(source[key]))) {\r\n                if (isPlainObject(source[key]) && !isPlainObject(target[key])) {\r\n                    target[key] = {};\r\n                }\r\n                if (isArray(source[key]) && !isArray(target[key])) {\r\n                    target[key] = [];\r\n                }\r\n                _mixin(target[key], source[key], deep, safe);\r\n            } else if (source[key] !== undefined) {\r\n                target[key] = source[key]\r\n            }\r\n        }\r\n        return target;\r\n    }\r\n\r\n    function _parseMixinArgs(args) {\r\n        var params = slice.call(arguments, 0);\r\n        target = params.shift(),\r\n            deep = false;\r\n        if (isBoolean(params[params.length - 1])) {\r\n            deep = params.pop();\r\n        }\r\n\r\n        return {\r\n            target: target,\r\n            sources: params,\r\n            deep: deep\r\n        };\r\n    }\r\n\r\n    function mixin() {\r\n        var args = _parseMixinArgs.apply(this, arguments);\r\n\r\n        args.sources.forEach(function(source) {\r\n            _mixin(args.target, source, args.deep, false);\r\n        });\r\n        return args.target;\r\n    }\r\n\r\n    function result(obj, path, fallback) {\r\n        if (!isArray(path)) {\r\n            path = [path]\r\n        };\r\n        var length = path.length;\r\n        if (!length) {\r\n          return isFunction(fallback) ? fallback.call(obj) : fallback;\r\n        }\r\n        for (var i = 0; i < length; i++) {\r\n          var prop = obj == null ? void 0 : obj[path[i]];\r\n          if (prop === void 0) {\r\n            prop = fallback;\r\n            i = length; // Ensure we don't continue iterating.\r\n          }\r\n          obj = isFunction(prop) ? prop.call(obj) : prop;\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    function safeMixin() {\r\n        var args = _parseMixinArgs.apply(this, arguments);\r\n\r\n        args.sources.forEach(function(source) {\r\n            _mixin(args.target, source, args.deep, true);\r\n        });\r\n        return args.target;\r\n    }\r\n\r\n    function substitute( /*String*/ template,\r\n        /*Object|Array*/\r\n        map,\r\n        /*Function?*/\r\n        transform,\r\n        /*Object?*/\r\n        thisObject) {\r\n        // summary:\r\n        //    Performs parameterized substitutions on a string. Throws an\r\n        //    exception if any parameter is unmatched.\r\n        // template:\r\n        //    a string with expressions in the form `${key}` to be replaced or\r\n        //    `${key:format}` which specifies a format function. keys are case-sensitive.\r\n        // map:\r\n        //    hash to search for substitutions\r\n        // transform:\r\n        //    a function to process all parameters before substitution takes\r\n\r\n\r\n        thisObject = thisObject || window;\r\n        transform = transform ?\r\n            proxy(thisObject, transform) : function(v) {\r\n                return v;\r\n            };\r\n\r\n        function getObject(key, map) {\r\n            if (key.match(/\\./)) {\r\n                var retVal,\r\n                    getValue = function(keys, obj) {\r\n                        var _k = keys.pop();\r\n                        if (_k) {\r\n                            if (!obj[_k]) return null;\r\n                            return getValue(keys, retVal = obj[_k]);\r\n                        } else {\r\n                            return retVal;\r\n                        }\r\n                    };\r\n                return getValue(key.split(\".\").reverse(), map);\r\n            } else {\r\n                return map[key];\r\n            }\r\n        }\r\n\r\n        return template.replace(/\\$\\{([^\\s\\:\\}]+)(?:\\:([^\\s\\:\\}]+))?\\}/g,\r\n            function(match, key, format) {\r\n                var value = getObject(key, map);\r\n                if (format) {\r\n                    value = getObject(format, thisObject).call(thisObject, value, key);\r\n                }\r\n                return transform(value, key).toString();\r\n            }); // String\r\n    }\r\n\r\n\r\n    var Stateful = Evented.inherit({\r\n        init : function(attributes, options) {\r\n            var attrs = attributes || {};\r\n            options || (options = {});\r\n            this.cid = uniqueId(this.cidPrefix);\r\n            this.attributes = {};\r\n            if (options.collection) this.collection = options.collection;\r\n            if (options.parse) attrs = this.parse(attrs, options) || {};\r\n            var defaults = result(this, 'defaults');\r\n            attrs = mixin({}, defaults, attrs);\r\n            this.set(attrs, options);\r\n            this.changed = {};\r\n        },\r\n\r\n        // A hash of attributes whose current and previous value differ.\r\n        changed: null,\r\n\r\n        // The value returned during the last failed validation.\r\n        validationError: null,\r\n\r\n        // The default name for the JSON `id` attribute is `\"id\"`. MongoDB and\r\n        // CouchDB users may want to set this to `\"_id\"`.\r\n        idAttribute: 'id',\r\n\r\n        // The prefix is used to create the client id which is used to identify models locally.\r\n        // You may want to override this if you're experiencing name clashes with model ids.\r\n        cidPrefix: 'c',\r\n\r\n\r\n        // Return a copy of the model's `attributes` object.\r\n        toJSON: function(options) {\r\n          return clone(this.attributes);\r\n        },\r\n\r\n\r\n        // Get the value of an attribute.\r\n        get: function(attr) {\r\n          return this.attributes[attr];\r\n        },\r\n\r\n        // Returns `true` if the attribute contains a value that is not null\r\n        // or undefined.\r\n        has: function(attr) {\r\n          return this.get(attr) != null;\r\n        },\r\n\r\n        // Set a hash of model attributes on the object, firing `\"change\"`. This is\r\n        // the core primitive operation of a model, updating the data and notifying\r\n        // anyone who needs to know about the change in state. The heart of the beast.\r\n        set: function(key, val, options) {\r\n          if (key == null) return this;\r\n\r\n          // Handle both `\"key\", value` and `{key: value}` -style arguments.\r\n          var attrs;\r\n          if (typeof key === 'object') {\r\n            attrs = key;\r\n            options = val;\r\n          } else {\r\n            (attrs = {})[key] = val;\r\n          }\r\n\r\n          options || (options = {});\r\n\r\n          // Run validation.\r\n          if (!this._validate(attrs, options)) return false;\r\n\r\n          // Extract attributes and options.\r\n          var unset      = options.unset;\r\n          var silent     = options.silent;\r\n          var changes    = [];\r\n          var changing   = this._changing;\r\n          this._changing = true;\r\n\r\n          if (!changing) {\r\n            this._previousAttributes = clone(this.attributes);\r\n            this.changed = {};\r\n          }\r\n\r\n          var current = this.attributes;\r\n          var changed = this.changed;\r\n          var prev    = this._previousAttributes;\r\n\r\n          // For each `set` attribute, update or delete the current value.\r\n          for (var attr in attrs) {\r\n            val = attrs[attr];\r\n            if (!isEqual(current[attr], val)) changes.push(attr);\r\n            if (!isEqual(prev[attr], val)) {\r\n              changed[attr] = val;\r\n            } else {\r\n              delete changed[attr];\r\n            }\r\n            unset ? delete current[attr] : current[attr] = val;\r\n          }\r\n\r\n          // Update the `id`.\r\n          if (this.idAttribute in attrs) this.id = this.get(this.idAttribute);\r\n\r\n          // Trigger all relevant attribute changes.\r\n          if (!silent) {\r\n            if (changes.length) this._pending = options;\r\n            for (var i = 0; i < changes.length; i++) {\r\n              this.trigger('change:' + changes[i], this, current[changes[i]], options);\r\n            }\r\n          }\r\n\r\n          // You might be wondering why there's a `while` loop here. Changes can\r\n          // be recursively nested within `\"change\"` events.\r\n          if (changing) return this;\r\n          if (!silent) {\r\n            while (this._pending) {\r\n              options = this._pending;\r\n              this._pending = false;\r\n              this.trigger('change', this, options);\r\n            }\r\n          }\r\n          this._pending = false;\r\n          this._changing = false;\r\n          return this;\r\n        },\r\n\r\n        // Remove an attribute from the model, firing `\"change\"`. `unset` is a noop\r\n        // if the attribute doesn't exist.\r\n        unset: function(attr, options) {\r\n          return this.set(attr, void 0, mixin({}, options, {unset: true}));\r\n        },\r\n\r\n        // Clear all attributes on the model, firing `\"change\"`.\r\n        clear: function(options) {\r\n          var attrs = {};\r\n          for (var key in this.attributes) attrs[key] = void 0;\r\n          return this.set(attrs, mixin({}, options, {unset: true}));\r\n        },\r\n\r\n        // Determine if the model has changed since the last `\"change\"` event.\r\n        // If you specify an attribute name, determine if that attribute has changed.\r\n        hasChanged: function(attr) {\r\n          if (attr == null) return !isEmptyObject(this.changed);\r\n          return this.changed[attr] !== undefined;\r\n        },\r\n\r\n        // Return an object containing all the attributes that have changed, or\r\n        // false if there are no changed attributes. Useful for determining what\r\n        // parts of a view need to be updated and/or what attributes need to be\r\n        // persisted to the server. Unset attributes will be set to undefined.\r\n        // You can also pass an attributes object to diff against the model,\r\n        // determining if there *would be* a change.\r\n        changedAttributes: function(diff) {\r\n          if (!diff) return this.hasChanged() ? clone(this.changed) : false;\r\n          var old = this._changing ? this._previousAttributes : this.attributes;\r\n          var changed = {};\r\n          for (var attr in diff) {\r\n            var val = diff[attr];\r\n            if (isEqual(old[attr], val)) continue;\r\n            changed[attr] = val;\r\n          }\r\n          return !isEmptyObject(changed) ? changed : false;\r\n        },\r\n\r\n        // Get the previous value of an attribute, recorded at the time the last\r\n        // `\"change\"` event was fired.\r\n        previous: function(attr) {\r\n          if (attr == null || !this._previousAttributes) return null;\r\n          return this._previousAttributes[attr];\r\n        },\r\n\r\n        // Get all of the attributes of the model at the time of the previous\r\n        // `\"change\"` event.\r\n        previousAttributes: function() {\r\n          return clone(this._previousAttributes);\r\n        },\r\n\r\n        // Create a new model with identical attributes to this one.\r\n        clone: function() {\r\n          return new this.constructor(this.attributes);\r\n        },\r\n\r\n        // A model is new if it has never been saved to the server, and lacks an id.\r\n        isNew: function() {\r\n          return !this.has(this.idAttribute);\r\n        },\r\n\r\n        // Check if the model is currently in a valid state.\r\n        isValid: function(options) {\r\n          return this._validate({}, mixin({}, options, {validate: true}));\r\n        },\r\n\r\n        // Run validation against the next complete set of model attributes,\r\n        // returning `true` if all is well. Otherwise, fire an `\"invalid\"` event.\r\n        _validate: function(attrs, options) {\r\n          if (!options.validate || !this.validate) return true;\r\n          attrs = mixin({}, this.attributes, attrs);\r\n          var error = this.validationError = this.validate(attrs, options) || null;\r\n          if (!error) return true;\r\n          this.trigger('invalid', this, error, mixin(options, {validationError: error}));\r\n          return false;\r\n        }\r\n    });\r\n\r\n    var _uid = 1;\r\n\r\n    function uid(obj) {\r\n        return obj._uid || (obj._uid = _uid++);\r\n    }\r\n\r\n    function uniq(array) {\r\n        return filter.call(array, function(item, idx) {\r\n            return array.indexOf(item) == idx;\r\n        })\r\n    }\r\n\r\n    var idCounter = 0;\r\n    function uniqueId (prefix) {\r\n        var id = ++idCounter + '';\r\n        return prefix ? prefix + id : id;\r\n    }\r\n\r\n    function langx() {\r\n        return langx;\r\n    }\r\n\r\n    mixin(langx, {\r\n        after: aspect(\"after\"),\r\n\r\n        around: aspect(\"around\"),\r\n\r\n        before: aspect(\"before\"),\r\n\r\n        camelCase: function(str) {\r\n            return str.replace(/-([\\da-z])/g, function(a) {\r\n                return a.toUpperCase().replace('-', '');\r\n            });\r\n        },\r\n        clone: clone,\r\n\r\n        compact: compact,\r\n\r\n        createEvent : createEvent,\r\n\r\n        dasherize: dasherize,\r\n\r\n        debounce: debounce,\r\n\r\n        delegate: delegate,\r\n\r\n        Deferred: Deferred,\r\n\r\n        Evented: Evented,\r\n\r\n        deserializeValue: deserializeValue,\r\n\r\n        each: each,\r\n\r\n        flatten: flatten,\r\n\r\n        funcArg: funcArg,\r\n\r\n        getQueryParams: getQueryParams,\r\n\r\n        inArray: inArray,\r\n\r\n        isArray: isArray,\r\n\r\n        isArrayLike: isArrayLike,\r\n\r\n        isBoolean: isBoolean,\r\n\r\n        isDefined: function(v) {\r\n            return v !== undefined;\r\n        },\r\n\r\n        isDocument: isDocument,\r\n\r\n        isEmptyObject: isEmptyObject,\r\n\r\n        isEqual: isEqual,\r\n\r\n        isFunction: isFunction,\r\n\r\n        isHtmlNode: isHtmlNode,\r\n\r\n        isObject: isObject,\r\n\r\n        isPlainObject: isPlainObject,\r\n\r\n        isNumber: isNumber,\r\n\r\n        isString: isString,\r\n\r\n        isSameOrigin: isSameOrigin,\r\n\r\n        isWindow: isWindow,\r\n\r\n        klass: function(props, parent, options) {\r\n            return createClass(props, parent, options);\r\n        },\r\n\r\n        lowerFirst: function(str) {\r\n            return str.charAt(0).toLowerCase() + str.slice(1);\r\n        },\r\n\r\n        makeArray: makeArray,\r\n\r\n        map: map,\r\n\r\n        mixin: mixin,\r\n\r\n        nextTick: nextTick,\r\n\r\n        proxy: proxy,\r\n\r\n        removeItem: removeItem,\r\n\r\n        result : result,\r\n        \r\n        returnTrue: function() {\r\n            return true;\r\n        },\r\n\r\n        returnFalse: function() {\r\n            return false;\r\n        },\r\n\r\n        safeMixin: safeMixin,\r\n\r\n        serializeValue: function(value) {\r\n            return JSON.stringify(value)\r\n        },\r\n\r\n        Stateful: Stateful,\r\n\r\n        substitute: substitute,\r\n\r\n        toPixel: toPixel,\r\n\r\n        trim: trim,\r\n\r\n        type: type,\r\n\r\n        uid: uid,\r\n\r\n        uniq: uniq,\r\n\r\n        uniqueId: uniqueId,\r\n\r\n        upperFirst: function(str) {\r\n            return str.charAt(0).toUpperCase() + str.slice(1);\r\n        },\r\n\r\n        URL: window.URL || window.webkitURL\r\n\r\n    });\r\n\r\n    return skylark.langx = langx;\r\n});"]}